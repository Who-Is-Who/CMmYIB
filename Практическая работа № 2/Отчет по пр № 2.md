# Отчет по практической работе № 2
## Выполнил: Студент группы ББМО-01-23 Панков Никита Олегович

### Цель работы:
  - Установить docker, docker-compose.
  - Установить образы с IPS Suricata или развернуть в виртуальной машине.
  - Настроить и запустить IPS Suricata на сетевом адаптере для обработки сетевых пакетов.
  - Обновить правила и создать произвольное правило для Suricata.
  - Смоделировать ситуацию вторжения, например путем сканирования сетевых портов сканером Nmap или любым средством тестирования на проникновение.
  - Вывести статистику и детекты вторжений в консоль или web-интерфейс.
  - Оформить выполнение задания в виде отчета со скриншотами, описанием команд и действий.

### Ход работы

Suricata - это мощная и гибкая система обнаружения вторжений в сеть (IDS) и система предотвращения вторжений (IPS). Она предназначена для мониторинга сетевого трафика и обнаружения различных типов атак, включая вирусы, вредоносные программы, атаки на основе сетевых уязвимостей и многое другое. Suricata может выполнять глубокий анализ сетевого трафика в реальном времени, а также поддерживает ряд функций, таких как сигнатурное обнаружение, анализ протоколов и распознавание аномалий. Она является свободно распространяемым программным обеспечением с открытым исходным кодом и широко используется для обеспечения безопасности сетей в корпоративных и других средах.   

  1) Установить docker, docker-compose.

Для установки docker и docker-compose необходимо открыть терминаль и впсиать в него следующую команду.  

    sudo apt-get install docker-compose

![](https://i.imgur.com/mdkdlyO.png)  

Чтобы убедиться в коректности установки docker и docker-compose используем слеующие команды.  

    docker -version  
    docker-compose -version  
![](https://i.imgur.com/5OKeSA8.png)

  2) Установить образы с IPS Suricata или развернуть в виртуальной машине.

Я решил использовать Suricata на виртуальной машине. Для этого сначала необходимо скачать ее. Воспользуемся следующей командой.  

    sudo apt-get install suricata  

  ![](https://i.imgur.com/1fbi7zx.png)

  3) Настроить и запустить IPS Suricata на сетевом адаптере для обработки сетевых пакетов.

Для настройки работы на определенном сетевом адаптере необходимо отредактировать конфигурационный файл Siricata.

    sudo nano /etc/suricata/suricata.yaml  

  Находим пункт отвечающий за выбор на каком сетевом адаптере будет работать и вписываем нужный нам. В нашем случае это eth0

  ![](https://i.imgur.com/lxiriD4.png)  
  
  ![](https://i.imgur.com/QJZIpXi.png)

  4) Обновить правила и создать произвольное правило для Suricata.

Для того чтобы обновить правила мы воспользуемся встроеной командой  

    sudo suricata-update  
  ![](https://i.imgur.com/FGn54ws.png)

Дальше создадим свое правило. Для начала создадим файл с именем **local.rules** в папке со всеми правилами  

    nano /etc/suricata/rules/local.rules  

![](https://i.imgur.com/xbDV6vd.png)  


И впишем туда наше правило  

    alert tcp any any -> any 22 (msg:"PANKOV.N.O"; sid:1000001; rev:1;)  
  где:  
- `alert` - это действие, которое отправляет предупреждение в лог-файл или консоль.
- `tcp` - это протокол, по которому Suricata анализирует трафик. В нашем случае это TCP.
- `any any` - Данное правило будет применятся к любому IP-адресу и порту, откуда идет трафик.
- `any 22` - это назначение трафика. Suricata будет применять правило к любому IP-адресу, но только к порту 22, на котором работает SSH.
- `msg:"PANKOV.N.0"` - это сообщение, которое будет выводиться, когда правило срабатывает.
- `sid:1000001` - это уникальный идентификатор правила, который Suricata использует для отслеживания и обновления правил.
- `rev:1` - это ревизия правила, которая Suricata использует для отслеживания изменений в правилах.  

5)   Смоделировать ситуацию вторжения, например путем сканирования сетевых портов сканером Nmap или любым средством тестирования на проникновение.

Для того чтоб Suricata нам что-то вывелеа мы должны сымитировать вторжение. Воспользуемся таким средством как nmap.  
Nmap (Network Mapper) - это мощный инструмент сканирования сети, который используется для изучения сетевых хостов и обнаружения служб, запущенных на этих хостах. Он позволяет администраторам сети проводить различные виды сканирования, такие как сканирование открытых портов, определение версий служб, обнаружение операционных систем и т. д. Nmap является инструментом с открытым исходным кодом и широко используется как для добросовестных, так и для злонамеренных целей.

Открываем терминал и вписываем данную команду  

    sudo nmap -sS -p 22 10.211.55.5  

где:
- `sS` - Этот флаг указывает nmap использовать сканирование TCP SYN. Это один из типов сканирования, используемых для определения состояния порта на удаленном хосте.
- `p` - Этот флаг указывает nmap сканировать только порт 22. Порт 22 является стандартным портом SSH (Secure Shell), который обычно используется для удаленного доступа к системе.
- `10.211.55.5` - Это IP-адрес целевого хоста, который будет просканирован.

![](https://i.imgur.com/ITQN9br.png)

6) Вывести статистику и детекты вторжений в консоль или web-интерфейс.

Для вывода статистики и детектов вторжений нам необходимо прочитать лог-файл в котором записаны все события связанные с вторжением. Для этого воспользуемся следующей командой  

    sudo tail -f /var/log/suricata/fast.log  

где:
- `tail` -  Это утилита в UNIX-подобных системах, которая выводит последние строки текстового файла.

- `f` - Этот флаг указывает tail на отслеживание изменений в файле в реальном времени. Он будет автоматически обновлять вывод команды, когда в файле появляются новые строки.

- `/var/log/suricata/fast.log` - Это путь к файлу журнала Suricata, который содержит быструю запись событий, обнаруженных системой Suricata.

![](https://i.imgur.com/xalhVZ1.png)

Вывод

В результате выполнения данной работы были достигнуты следующие результаты:

- Установлены образы с IPS Suricata на операционной системе Kali Linux.
- Настроен и запущен IPS Suricata на сетевом адаптере для обработки сетевых пакетов.
- Обновлены правила и создано произвольное правило для Suricata, которое срабатывает при попытке подключения к порту 22 по протоколу TCP.
- Смоделирована ситуация вторжения, путем сканирования сетевых портов сканером Nmap с другого компьютера в той же сети.
- Выведена статистика и детекты вторжений в консоль, показывающие, что Suricata успешно обнаружил и заблокировал попытку подключения к порту 22.

Основные выводы, которые можно сделать на основе проделанной работы, следующие:

- IPS Suricata - это эффективный и гибкий инструмент для обнаружения и предотвращения вторжений в сеть, который может быть легко установлен и настроен на различных операционных системах, в том числе на Kali Linux.
- IPS Suricata позволяет создавать и обновлять правила, которые определяют, как Suricata должен реагировать на определенные виды трафика, в зависимости от целей и потребностей пользователя.
- IPS Suricata показывает высокую производительность и стабильность в работе, а также предоставляет различные способы мониторинга и анализа сетевой активности и событий, связанных с вторжениями.

В заключение, можно сказать, что данная работа позволила ознакомиться с основными принципами и функциями IPS Suricata, а также продемонстрировать его практическое применение для обеспечения безопасности сети. Эта работа также способствовала развитию навыков установки, настройки и тестирования систем обнаружения и предотвращения вторжений на примере Suricata.

     
